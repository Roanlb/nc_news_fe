{"ast":null,"code":"import _toConsumableArray from\"/home/roan/Desktop/fe-nc-news/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/roan/Desktop/fe-nc-news/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/roan/Desktop/fe-nc-news/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/roan/Desktop/fe-nc-news/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/roan/Desktop/fe-nc-news/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/roan/Desktop/fe-nc-news/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Link}from'@reach/router';import*as api from'../utils/axiosRequests';import Voter from'./Voter';import CommentList from'./CommentList';import ErrorPage from'./ErrorPage';var SingleArticle=/*#__PURE__*/function(_Component){_inherits(SingleArticle,_Component);function SingleArticle(){var _getPrototypeOf2;var _this;_classCallCheck(this,SingleArticle);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(SingleArticle)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={article:{},comments:[],commentToPost:'',err:'',commentWarning:''};_this.handleChange=function(event){_this.setState({commentToPost:event.target.value});};_this.handlePostComment=function(event){event.preventDefault();if(!_this.state.commentToPost||!_this.props.user){_this.setState({commentWarning:'You must be signed in and have filled in the comment box in order to post a comment'});}else{var commentToPost=_this.state.commentToPost;var user=_this.props.user;var article_id=_this.props.article_id;api.postComment(commentToPost,user,article_id).then(function(_ref){var comment=_ref.data.comment;_this.setState(function(currentState){return{comments:[comment].concat(_toConsumableArray(currentState.comments)),commentToPost:''};});}).catch(function(_ref2){var response=_ref2.response;_this.setState({err:response.data.msg,isLoading:false});});}};_this.handleDelete=function(event){var comment_id=event.target.parentElement.id;api.deleteComment(comment_id).then(function(){api.getArticleComments(_this.props.article_id).then(function(comments){_this.setState({comments:comments});}).catch(function(_ref3){var response=_ref3.response;_this.setState({err:response.data.msg,isLoading:false});});});};return _this;}_createClass(SingleArticle,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;Promise.all([api.getSingleArticle(this.props.article_id),api.getArticleComments(this.props.article_id)]).then(function(resolutions){_this2.setState({article:resolutions[0],comments:resolutions[1]});}).catch(function(_ref4){var response=_ref4.response;_this2.setState({err:response.data.msg,isLoading:false});});}},{key:\"render\",value:function render(){console.log(this.props.user,'this props user');return React.createElement(\"div\",{id:this.props.article_id},this.state.err?React.createElement(ErrorPage,{err:this.state.err}):React.createElement(React.Fragment,null,React.createElement(\"h2\",null,this.state.article.title),React.createElement(Voter,{votes:this.state.article.votes,type:\"articles\",id:this.props.article_id}),React.createElement(Link,{to:\"/\".concat(this.state.article.topic)},React.createElement(\"h6\",null,\"See all \",this.state.article.topic,\" stories\")),React.createElement(\"p\",null,this.state.article.body),React.createElement(\"h4\",null,\"Comments\"),React.createElement(\"form\",{onSubmit:this.handlePostComment},React.createElement(\"h3\",null,\"Post a comment: \"),React.createElement(\"textarea\",{className:\"CommentInput\",name:\"commentPost\",id:\"commentPost\",onChange:this.handleChange,value:this.state.commentToPost,placeholder:this.state.commentWarning}),React.createElement(\"input\",{type:\"submit\"})),this.state.comments&&React.createElement(CommentList,{comments:this.state.comments,handleDelete:this.handleDelete,user:this.props.user})));}}]);return SingleArticle;}(Component);export default SingleArticle;","map":{"version":3,"sources":["/home/roan/Desktop/fe-nc-news/src/components/SingleArticle.jsx"],"names":["React","Component","Link","api","Voter","CommentList","ErrorPage","SingleArticle","state","article","comments","commentToPost","err","commentWarning","handleChange","event","setState","target","value","handlePostComment","preventDefault","props","user","article_id","postComment","then","comment","data","currentState","catch","response","msg","isLoading","handleDelete","comment_id","parentElement","id","deleteComment","getArticleComments","Promise","all","getSingleArticle","resolutions","console","log","title","votes","topic","body"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Link } from '@reach/router';\nimport * as api from '../utils/axiosRequests';\nimport Voter from './Voter';\nimport CommentList from './CommentList';\nimport ErrorPage from './ErrorPage';\n\nclass SingleArticle extends Component {\n  state = {\n    article: {},\n    comments: [],\n    commentToPost: '',\n    err: '',\n    commentWarning: ''\n  };\n\n  handleChange = event => {\n    this.setState({ commentToPost: event.target.value });\n  };\n\n  handlePostComment = event => {\n    event.preventDefault();\n    if (!this.state.commentToPost || !this.props.user) {\n      this.setState({\n        commentWarning:\n          'You must be signed in and have filled in the comment box in order to post a comment'\n      });\n    } else {\n      let commentToPost = this.state.commentToPost;\n      let user = this.props.user;\n      let article_id = this.props.article_id;\n\n      api\n        .postComment(commentToPost, user, article_id)\n        .then(({ data: { comment } }) => {\n          this.setState(currentState => {\n            return {\n              comments: [comment, ...currentState.comments],\n              commentToPost: ''\n            };\n          });\n        })\n        .catch(({ response }) => {\n          this.setState({ err: response.data.msg, isLoading: false });\n        });\n    }\n  };\n\n  handleDelete = event => {\n    let comment_id = event.target.parentElement.id;\n    api.deleteComment(comment_id).then(() => {\n      api\n        .getArticleComments(this.props.article_id)\n        .then(comments => {\n          this.setState({ comments: comments });\n        })\n        .catch(({ response }) => {\n          this.setState({ err: response.data.msg, isLoading: false });\n        });\n    });\n  };\n\n  componentDidMount() {\n    Promise.all([\n      api.getSingleArticle(this.props.article_id),\n      api.getArticleComments(this.props.article_id)\n    ])\n      .then(resolutions => {\n        this.setState({\n          article: resolutions[0],\n          comments: resolutions[1]\n        });\n      })\n      .catch(({ response }) => {\n        this.setState({ err: response.data.msg, isLoading: false });\n      });\n  }\n\n  render() {\n    console.log(this.props.user, 'this props user');\n    return (\n      <div id={this.props.article_id}>\n        {this.state.err ? (\n          <ErrorPage err={this.state.err} />\n        ) : (\n          <>\n            <h2>{this.state.article.title}</h2>\n            <Voter\n              votes={this.state.article.votes}\n              type=\"articles\"\n              id={this.props.article_id}\n            />\n            <Link to={`/${this.state.article.topic}`}>\n              <h6>See all {this.state.article.topic} stories</h6>\n            </Link>\n            <p>{this.state.article.body}</p>\n            <h4>Comments</h4>\n            <form onSubmit={this.handlePostComment}>\n              <h3>Post a comment: </h3>\n              <textarea\n                className=\"CommentInput\"\n                name=\"commentPost\"\n                id=\"commentPost\"\n                onChange={this.handleChange}\n                value={this.state.commentToPost}\n                placeholder={this.state.commentWarning}\n              ></textarea>\n              <input type=\"submit\" />\n            </form>\n            {this.state.comments && (\n              <CommentList\n                comments={this.state.comments}\n                handleDelete={this.handleDelete}\n                user={this.props.user}\n              />\n            )}\n          </>\n        )}\n      </div>\n    );\n  }\n}\nexport default SingleArticle;\n"]},"metadata":{},"sourceType":"module"}