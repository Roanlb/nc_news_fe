(this.webpackJsonpfront_nc_news=this.webpackJsonpfront_nc_news||[]).push([[0],{1:function(e,t,a){var n=a(38);e.exports={getTopics:function(){return n.get("https://roanncnewsserver.herokuapp.com/api/topics").then((function(e){return e.data.topics}))},getSingleArticle:function(e){return n.get("https://roanncnewsserver.herokuapp.com/api/articles/".concat(e)).then((function(e){return e.data.article}))},getArticleComments:function(e){return n.get("https://roanncnewsserver.herokuapp.com/api/articles/".concat(e,"/comments")).then((function(e){return e.data.comments}))},getSortedArticles:function(e,t){return n.get("https://roanncnewsserver.herokuapp.com/api/articles",{params:{topic:e,sort_by:t}}).then((function(e){return e.data.articles}))},postComment:function(e,t,a){return n.post("https://roanncnewsserver.herokuapp.com/api/articles/".concat(a,"/comments"),{username:t,body:e})},deleteComment:function(e){return n.delete("https://roanncnewsserver.herokuapp.com/api/comments/".concat(e))},vertasilePatch:function(e,t,a){return console.log(e,t,a),n.patch("https://roanncnewsserver.herokuapp.com/api/".concat(a,"/").concat(t),{inc_votes:e})}}},23:function(e,t,a){e.exports=a(57)},28:function(e,t,a){},29:function(e,t,a){},57:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(20),c=a.n(r),s=(a(28),a(4)),i=a(5),l=a(7),m=a(6),u=a(8),p=(a(29),a(3)),h=function(e){var t=e.user;return o.a.createElement("div",{className:"Header"},o.a.createElement(p.a,{to:"/"},o.a.createElement("h3",null,"NC News ")),o.a.createElement("h4",null,t?"Welcome ".concat(t,", you are logged in"):"You are not logged in"))},d=a(1),g=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={topics:[],isLoading:!0,err:""},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.getTopics().then((function(t){e.setState({topics:t,isLoading:!1})})).catch((function(t){var a=t.response;e.setState({err:a.data.msg,isLoading:!1})}))}},{key:"render",value:function(){return o.a.createElement("div",{className:"NavBar"},o.a.createElement("h4",{className:"NavBarTitle"}," Stories by topic"),this.state.isLoading&&o.a.createElement(o.a.Fragment,null,o.a.createElement("h4",null,"Loading..."),o.a.createElement("img",{src:"https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif",alt:"a triforce logo with the tiles rotating"})),this.state.err?o.a.createElement("h1",null,"Oops! Couldn't find today's topics"):o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"NavBarList"},this.state.topics.map((function(e){return o.a.createElement("div",{className:"NavButton",key:e.slug},o.a.createElement(p.a,{to:e.slug},e.slug),o.a.createElement("h6",null,e.description))})))))}}]),t}(n.Component),v=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={optimisticVotes:0},a.handleVote=function(e){var t=+e.target.id,n=a.props.id,o=a.props.type;0!==a.state.optimisticVotes?(d.vertasilePatch(-a.state.optimisticVotes,n,o),a.setState({optimisticVotes:0})):d.vertasilePatch(t,n,o).then((function(){a.setState({optimisticVotes:t})}))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"Voter"},o.a.createElement("h5",{className:"VoterText"},"Votes: "),o.a.createElement("button",{className:"VoteButton",onClick:this.handleVote,id:"1"},"Upvote"),o.a.createElement("p",{className:"VoterText"},this.state.optimisticVotes?this.props.votes+this.state.optimisticVotes:this.props.votes),o.a.createElement("button",{className:"VoteButton",onClick:this.handleVote,id:"-1"},"Downvote"))}}]),t}(n.Component),f=function(e){var t=e.title,a=e.id,n=e.topic,r=e.mainFeed,c=e.votes,s=e.comment_count;return o.a.createElement("li",{className:"ArticleCard"},o.a.createElement(p.a,{to:"/".concat(n,"/").concat(a),article_id:a,className:"ArticleTitle"},o.a.createElement("h4",null,t)),o.a.createElement("aside",{className:"ArticleVoter"},o.a.createElement(v,{votes:c,type:"articles",id:a})),r?o.a.createElement(p.a,{className:"ArticleSeeAll",to:"/".concat(n)},o.a.createElement("h6",null,"See all ",n," stories")):o.a.createElement("h6",null,"Comment count: ",s))},E=function(e){return o.a.createElement("section",null,o.a.createElement("h1",null,"Oops! ",e.err),o.a.createElement("img",{src:"https://www.ionos.com/digitalguide/fileadmin/DigitalGuide/Teaser/404-not-found-t.jpg",alt:"A giant baby who has just eaten the page",width:"100%"}))},b=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={articles:[],isLoading:!0,err:""},a.handleSelectChange=function(e){var t=e.target.value;console.log(t,"value"),console.log(a.props.topic,"this proprs topic"),d.getSortedArticles(a.props.topic,t).then((function(e){a.setState({articles:e}).catch((function(e){var t=e.response;a.setState({err:t.data.msg,isLoading:!1})}))}))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.getSortedArticles(this.props.topic).then((function(t){e.setState({articles:t,isLoading:!1})})).catch((function(t){var a=t.response;console.log(a),e.setState({err:a.data.msg,isLoading:!1})}))}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.props.topic!==e.topic&&d.getSortedArticles(this.props.topic).then((function(e){a.setState({articles:e})})).catch((function(e){var t=e.response;a.setState({err:t.data.msg,isLoading:!1})}))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("aside",null,o.a.createElement("h4",null,"Sort by:"),o.a.createElement("select",{name:"articleSelector",id:"articleSelector",onChange:this.handleSelectChange},o.a.createElement("option",{value:"created_at"},"Date created"),o.a.createElement("option",{value:"comment_count"},"Comment count"),o.a.createElement("option",{value:"votes"},"Votes"))),o.a.createElement("ul",{className:"ArticleList"},this.state.isLoading&&!this.state.err&&o.a.createElement("h4",null,"Loading..."),this.state.articles.map((function(t){return console.log(t.votes),o.a.createElement(f,{key:t.article_id,title:t.title,votes:t.votes,topic:t.topic,id:t.article_id,mainFeed:e.props.mainFeed,comment_count:t.comment_count})}))),this.state.err&&o.a.createElement(E,{err:this.state.err}))}}]),t}(n.Component),y=a(22),C=function(e){var t=e.comments,a=e.handleDelete,n=e.user;return console.log(n,"user in commentList"),o.a.createElement("ul",{className:"CommentList"},t.map((function(e){return console.log(e.author,n),o.a.createElement("li",{key:e.comment_id,id:e.comment_id,className:"OneComment"},o.a.createElement("h5",{className:"CommentText"},e.author),o.a.createElement("p",{className:"CommentText"},e.body),o.a.createElement(v,{votes:e.votes,type:"comments",id:e.comment_id}),o.a.createElement("h6",{className:"CommentText"},"Created at: ",e.created_at),n===e.author&&o.a.createElement("button",{className:"DeleteButton",onClick:a},"Delete"))})))},S=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={article:{},comments:[],commentToPost:"",err:"",commentWarning:""},a.handleChange=function(e){a.setState({commentToPost:e.target.value})},a.handlePostComment=function(e){if(e.preventDefault(),a.state.commentToPost&&a.props.user){var t=a.state.commentToPost,n=a.props.user,o=a.props.article_id;d.postComment(t,n,o).then((function(e){var t=e.data.comment;a.setState((function(e){return{comments:[t].concat(Object(y.a)(e.comments)),commentToPost:""}}))})).catch((function(e){var t=e.response;a.setState({err:t.data.msg,isLoading:!1})}))}else a.setState({commentWarning:"You must be signed in and have filled in the comment box in order to post a comment"})},a.handleDelete=function(e){var t=e.target.parentElement.id;d.deleteComment(t).then((function(){d.getArticleComments(a.props.article_id).then((function(e){a.setState({comments:e})})).catch((function(e){var t=e.response;a.setState({err:t.data.msg,isLoading:!1})}))}))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;Promise.all([d.getSingleArticle(this.props.article_id),d.getArticleComments(this.props.article_id)]).then((function(t){e.setState({article:t[0],comments:t[1]})})).catch((function(t){var a=t.response;e.setState({err:a.data.msg,isLoading:!1})}))}},{key:"render",value:function(){return console.log(this.props.user,"this props user"),o.a.createElement("div",{id:this.props.article_id},this.state.err?o.a.createElement(E,{err:this.state.err}):o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,this.state.article.title),o.a.createElement(v,{votes:this.state.article.votes,type:"articles",id:this.props.article_id}),o.a.createElement(p.a,{to:"/".concat(this.state.article.topic)},o.a.createElement("h6",null,"See all ",this.state.article.topic," stories")),o.a.createElement("p",null,this.state.article.body),o.a.createElement("h4",null,"Comments"),o.a.createElement("form",{onSubmit:this.handlePostComment},o.a.createElement("h3",null,"Post a comment: "),o.a.createElement("textarea",{className:"CommentInput",name:"commentPost",id:"commentPost",onChange:this.handleChange,value:this.state.commentToPost,placeholder:this.state.commentWarning}),o.a.createElement("input",{type:"submit"})),this.state.comments&&o.a.createElement(C,{comments:this.state.comments,handleDelete:this.handleDelete,user:this.props.user})))}}]),t}(n.Component),j=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={username:"jessjelly"},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(h,{user:this.state.username}),o.a.createElement(g,null),o.a.createElement(p.b,{className:"ArticleView"},o.a.createElement(b,{path:"/",mainFeed:!0}),o.a.createElement(b,{path:"/:topic",mainFeed:!1}),o.a.createElement(S,{path:"/:topic/:article_id",user:this.state.username}),o.a.createElement(E,{default:!0})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[23,1,2]]]);
//# sourceMappingURL=main.825a628a.chunk.js.map